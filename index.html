<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Пиццерия «По кругу» v0.1</title>
  <meta name="description" content="Виртуальная пицца и жирные ссылки.">
  <meta name="robots" content="index, follow">
  <meta name="theme-color" content="#C2242E">
  <link rel="canonical" href="https://svarganil.ru/">
  <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg">
  <link rel="shortcut icon" href="/favicon/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <meta name="apple-mobile-web-app-title" content="Сварганил v0.1">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <meta property="og:title" content="Пиццерия «По кругу» v0.1">
  <meta property="og:description" content="Виртуальная пицца и жирные ссылки.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://svarganil.ru/">
  <meta property="og:image" content="/preview.jpg">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Пиццерия «По кругу» v0.1">
  <meta name="twitter:description" content="Виртуальная пицца и жирные ссылки.">
  <meta name="twitter:image" content="/preview.jpg">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Marck+Script&display=swap&subset=cyrillic" rel="stylesheet">
</head>

<body>

<audio id="jungletrain-bg" preload="none" playsinline>
  <source src="https://chat.jungletrain.net/streamtest/;stream/1" type="audio/mpeg">
</audio>

<script>
  const radio = document.getElementById("jungletrain-bg");
  radio.volume = 0.3;

  let radioStarted = false;
  let radioVolumeFadeToken = 0;

  const startRadio = () => {
    if (radioStarted) return;
    radio.play()
      .then(() => {
        radioStarted = true;
      })
      .catch(() => {});
  };

  const fadeRadioVolumeTo = (targetVolume, durationMs = 350) => {
    const token = ++radioVolumeFadeToken;
    const from = radio.volume;
    const to = Math.min(1, Math.max(0, targetVolume));

    if (durationMs <= 0) {
      radio.volume = to;
      return;
    }

    const startAt = performance.now();
    const step = (now) => {
      if (token !== radioVolumeFadeToken) return; // cancelled by a newer fade
      const t = Math.min(1, (now - startAt) / durationMs);
      const eased = t * t * (3 - 2 * t); // smoothstep
      radio.volume = from + (to - from) * eased;
      if (t < 1) requestAnimationFrame(step);
    };

    requestAnimationFrame(step);
  };
</script>

<article class="contain">
  <section class="pizza-hover">
    <div class="pizza-box">
      <div class="pizza-box-side left-side"></div>
      <div class="pizza-box-side right-side"></div>
      <div class="pizza-box-side front-side"></div>
      <div class="pizza-box-side back-side"></div>
      <div class="lid">
        <svg width="512" height="387" viewBox="0 0 512 387" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M256.501 0C429.339 0 502.481 67.3481 512 177.417H312.11C307.601 160.831 293.072 145.753 256 145.753C216.423 145.753 197.886 164.852 197.886 191.49V195.51C197.886 222.148 216.423 241.247 256 241.247C293.072 241.247 307.601 226.169 312.11 209.583H512C502.481 319.652 429.339 387 256.501 387C79.6556 387 0 307.087 0 203.049V193.5C38.1312 193.5 69.6421 165.119 74.6096 128.303C83.8511 133.033 94.3202 135.701 105.412 135.701C142.837 135.701 173.176 105.324 173.176 67.8506C173.176 63.6164 172.789 59.4727 172.045 55.4554C179.324 58.581 187.343 60.3117 195.765 60.3117C228.699 60.3117 255.46 33.8466 255.992 0.997364L256 0.00251299L256.501 0Z"/>
        </svg>
      </div>
      <div class="lid-underside">
        <svg width="512" height="387" viewBox="0 0 512 387" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M256.501 0C429.339 0 502.481 67.3481 512 177.417H312.11C307.601 160.831 293.072 145.753 256 145.753C216.423 145.753 197.886 164.852 197.886 191.49V195.51C197.886 222.148 216.423 241.247 256 241.247C293.072 241.247 307.601 226.169 312.11 209.583H512C502.481 319.652 429.339 387 256.501 387C79.6556 387 0 307.087 0 203.049V193.5C38.1312 193.5 69.6421 165.119 74.6096 128.303C83.8511 133.033 94.3202 135.701 105.412 135.701C142.837 135.701 173.176 105.324 173.176 67.8506C173.176 63.6164 172.789 59.4727 172.045 55.4554C179.324 58.581 187.343 60.3117 195.765 60.3117C228.699 60.3117 255.46 33.8466 255.992 0.997364L256 0.00251299L256.501 0Z"/>
        </svg>
      </div>
      
      <div class="pizza">
        <div class="sauce">
          <div class="toppings">
            <div class="topping-1"></div>
          </div>
        </div>
      </div>
    </div>
  </section>
</article>

<div class="menu-shell" id="menu-sheet" aria-hidden="true">
  <div class="menu-top">
    <div class="menu-top-row">
      <div class="menu-label" id="menu-label">☰</div>
      <div class="menu-links">
        <a href="https://t.me/slappetizer" target="_blank" rel="noopener"><span class="link-full">ТЕЛЕГРАМ</span><span class="link-short">TG</span></a>
        <a href="https://instagram.com/slappetizer" target="_blank" rel="noopener"><span class="link-full">ИНСТАГРАМ</span><span class="link-short">IG</span></a>
        <a href="https://youtube.com/@slappetizer" target="_blank" rel="noopener"><span class="link-full">ЮТУБ</span><span class="link-short">YT</span></a>
        <a href="https://vk.com/slappetizer" target="_blank" rel="noopener"><span class="link-full">ВК</span><span class="link-short">VK</span></a>
        <a href="mailto:a@svarganil.ru"><span class="link-full">ПОЧТА</span><span class="link-short">ПОЧТА</span></a>
      </div>
    </div>
    <div class="menu-divider" aria-hidden="true">========================================================================================================================</div>
  </div>
  <div class="menu-footer">
    <span>Музыка на сайте ‣ <a href="https://jungletrain.net" target="_blank" rel="noopener">jungletrain.net</a></span>
    <span class="menu-copyright">© 2026 Сварганил</span>
  </div>
</div>

  <audio id="openSound" src="assets/open.mp3" preload="auto"></audio>
  <audio id="closeSound" src="assets/close.mp3" preload="auto"></audio>
  <audio id="menuOpenSound" src="assets/in.mp3" preload="auto"></audio>
  <audio id="menuCloseSound" src="assets/out.mp3" preload="auto"></audio>

  <script>
    let boxWasOpenedOnce = false;

    document.querySelector('.pizza-box').addEventListener('click', function() {
      const isOpen = this.classList.toggle('open');
      const openSound = document.getElementById('openSound');
      const closeSound = document.getElementById('closeSound');

      if (isOpen) {
        startRadio();
        openSound.play();
        if (!boxWasOpenedOnce) {
          // самое первое открытие (которое включает радио) — без fade
          radio.volume = 0.3;
          boxWasOpenedOnce = true;
        } else {
          fadeRadioVolumeTo(0.3, 350);
        }
      } else {
        closeSound.play();
        if (boxWasOpenedOnce) {
          fadeRadioVolumeTo(0, 350);
        } else {
          radio.volume = 0;
        }
      }
    });

    const menuSheet = document.getElementById('menu-sheet');
    const menuLabel = document.getElementById('menu-label');

    const updateMenuLabel = (isOpen) => {
      if (!menuLabel) return;
      menuLabel.textContent = isOpen ? '✕' : '☰';
    };

    const toggleMenu = () => {
      const isOpen = menuSheet.classList.toggle('open');
      menuSheet.setAttribute('aria-hidden', String(!isOpen));
      updateMenuLabel(isOpen);
      const sound = document.getElementById(isOpen ? 'menuOpenSound' : 'menuCloseSound');
      if (sound) {
        sound.currentTime = 0;
        sound.play().catch(() => {});
      }
    };

    if (menuLabel) {
      menuLabel.addEventListener('click', (event) => {
        event.stopPropagation();
        toggleMenu();
      });
      updateMenuLabel(menuSheet.classList.contains('open'));
    }

    menuSheet.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', (event) => event.stopPropagation());
    });
  </script>
</body>
</html>
